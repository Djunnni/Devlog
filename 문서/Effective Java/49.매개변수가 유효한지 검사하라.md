## 매개변수가 유효한지 검사하라

생성자나 메서드 대부분은 매개변수의 값이 특정조건을 만족하기를 바란다.

ex) 양수의 값만, 객체는 null이 아니어야 하는식

이런 제약들은 문서화해야하며 메서드 몸체가 시작되기 전에 검사해야한다.

"오류는 가능한  한 빨리 (발생한 곳에서) 잡아야 한다"는 일반 우너칙을 한 사례이기도 하다.
> javaScript에서는 hapi를 써서 검사했던 적이 있다.

오류를 발생한 즉시 잡지 못하면 해당 오류를 감지하기 어려워지고, 감지하더라도 오류의 발생 지점을 찾기 어려워진다

메서드 몸체가 실행되기 전에 매개변수를 확인한다면 잘못된 값이 넘어왔을 때 즉각적이고 깔끔한 방식으로 예외를 던질 수 있다.

#### 매개변수 검사를 제대로 하지 못하면 발생하는 일

1. 메서드가 수행되는 중간에 모호한 예외를 던지며 실패할 수 있다.
> 더 나아가지않아 그나마 다행이다..
2. 메서드가 잘 실행되지만 잘못된 결과를 반환할 때,
> jest를 통해 테스트하면서 검사했던 것 같다.
3. 메서드는 문제없이 수행되지만 어떤 객체를 이상한 상태를 만들어 놓아 미래에 알 수 없는 시점에 이 메서드와 관련없는 오류를 낸다.
> javascript에서 이 부분을 한 번 놓치면 끔찍한데 그래서 debug를 더 열심히 했던 부분이다.

=> 매개변수 검사에 실패하면 실패 원자성을 어기는 결과가 된다.
> 실패 원자성이 무엇인지는 검색해서 배워야겠다.

#### 취해야할 조치

1. public, protected 메서드는 매개변수 값이 잘못됐을 때, 던지는 예외를 문서화 해야한다.

보통은 NullPointerException, IndexOutBoundsException, IllegalArgumentException이 된다.

2. 매개변수 제약을 문서화한다면 그 제약을 어겼을 때 발생하는 예외도 함께 기술해야한다.

#### java7 requireNonNull

자바7에서 추가된 java.util.objects.requireNonNull 메서드는 유연하고 사용하기 편하니 더이상 null 검사를 수동으로 하지 않아도 된다.

반환값은 무시하고 필요한 곳 어디든 순수한 null 검사 목적으로 사용해도 된다.

### assert

개발 및 테스트 단계에서 메서드에 assert문을 작성하면 되는데 assert true라면 하위 수행, false면 멈춘다.

false면 AssertionError를 던진다.

런타임에 아무런 효과도, 아무런 성능저하도 없다. 단, (--ea, --enableassertions 플래그를 설정하면 런타임에 영향을 준다.) 

### 메서드 몸체 실행전에 매개변수 유효성을 검사해야하는 규칙에도 예외가 있다.

유효성 검사 비용이 지나치게 높거나 실용적이지 않을 때, 혹은 계산과정에서 암묵적으로 검사가 수행될 때다.

=> 암묵적 검사에 너무 의존했다가는 실패 원자성을 해칠 수 있다.

### 정리

매개변수에 제약을 두기보다. 최대한 범용적으로 설계해야한다. 메서드가 건네받은 값으로 무언가 제대로 된 일을 할 수 있다면 매개변수 제약은 적을 수록 좋다.

#### 공부해야할 단어

1. 실패 원자성

